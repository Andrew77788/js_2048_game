var e,t={};const s=new((e=class{constructor(e=4){this.size=e,this.board=this.createBoard(),this.score=0}createBoard(){return Array(this.size).fill().map(()=>Array(this.size).fill(0))}addTile(){let e=[];for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++)0===this.board[t][s]&&e.push({row:t,col:s});if(e.length>0){let{row:t,col:s}=e[Math.floor(Math.random()*e.length)];this.board[t][s]=.9>Math.random()?2:4}}moveLeft(){let e=!1;for(let t=0;t<this.size;t++){let s=this.board[t].filter(e=>e);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0,e=!0);for(s=s.filter(e=>e);s.length<this.size;)s.push(0);e||(e=this.board[t].toString()!==s.toString()),this.board[t]=s}return e}moveRight(){this.board=this.board.map(e=>e.reverse());let e=this.moveLeft();return this.board=this.board.map(e=>e.reverse()),e}moveUp(){this.transpose();let e=this.moveLeft();return this.transpose(),e}moveDown(){this.transpose();let e=this.moveRight();return this.transpose(),e}getScore(){return this.score}getState(){return this.board}getStatus(){return this.checkWin()?"win":this.isGameOver()?"lose":"playing"}start(){this.board=this.createBoard(),this.score=0,this.status="playing",this.addTile(),this.addTile(),this.updateBoard(),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".start").textContent="Restart"}restart(){this.board=this.createBoard(),this.score=0,this.addTile(),this.addTile(),this.updateBoard(),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden")}updateBoard(){let e=document.querySelectorAll(".field-cell"),t=0;for(let s=0;s<this.size;s++)for(let r=0;r<this.size;r++)e[t].textContent=0!==this.board[s][r]?this.board[s][r]:"",e[t].className="field-cell",0!==this.board[s][r]&&e[t].classList.add(`field-cell--${this.board[s][r]}`),t++;document.querySelector(".game-score").textContent=this.score}transpose(){this.board=this.board[0].map((e,t)=>this.board.map(e=>e[t]))}checkWin(){return this.board.some(e=>e.includes(2048))}isGameOver(){for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++)if(0===this.board[e][t]||t<this.size-1&&this.board[e][t]===this.board[e][t+1]||e<this.size-1&&this.board[e][t]===this.board[e+1][t])return!1;return!0}move(e){let t=!1;switch(e){case"ArrowLeft":t=this.moveLeft();break;case"ArrowRight":t=this.moveRight();break;case"ArrowUp":t=this.moveUp();break;case"ArrowDown":t=this.moveDown()}if(t){this.addTile(),this.updateBoard();let e=this.getStatus();"win"===e?document.querySelector(".message-win").classList.remove("hidden"):"lose"===e&&document.querySelector(".message-lose").classList.remove("hidden")}}}).__esModule?e.default:e);s.updateBoard(),document.addEventListener("keydown",e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(event.key)&&s.move(e.key)}),document.querySelector(".start").addEventListener("click",()=>{s.start()});
//# sourceMappingURL=index.b2c0c447.js.map
